"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5371],{5371:(j,h,c)=>{c.r(h),c.d(h,{SettingsPageModule:()=>S});var m=c(2200),v=c(4341),l=c(7343),p=c(8132),s=c(467),e=c(3664),b=c(4796),P=c(6386),_=c(7291),y=c(1924);function C(i,a){if(1&i&&e.nrm(0,"img",27),2&i){const d=e.XpG();e.Y8G("src",d.userPhoto,e.B4B)}}function k(i,a){1&i&&e.nrm(0,"ion-icon",28)}function x(i,a){if(1&i&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&i){const d=e.XpG();e.R7$(),e.SpI("",d.pendingSync," elementos pendientes")}}function F(i,a){1&i&&(e.j41(0,"p"),e.EFF(1,"Todo sincronizado"),e.k0s())}function M(i,a){if(1&i&&(e.j41(0,"ion-badge",29),e.EFF(1),e.k0s()),2&i){const d=e.XpG();e.R7$(),e.JRh(d.pendingSync)}}let O=(()=>{var i;class a{constructor(t,r,n,o,g,u){this.authService=t,this.syncService=r,this.storageService=n,this.router=o,this.alertCtrl=g,this.toastCtrl=u,this.userName="",this.userEmail="",this.userPhoto="",this.pendingSync=0,this.isOnline=!0,this.appVersion="1.0.0"}ngOnInit(){var t=this;return(0,s.A)(function*(){yield t.loadUserData(),t.pendingSync=yield t.syncService.getPendingCount()})()}ionViewWillEnter(){var t=this;return(0,s.A)(function*(){yield t.loadUserData()})()}loadUserData(){var t=this;return(0,s.A)(function*(){const r=t.authService.currentUser;r&&(t.userName=r.name||"Usuario",t.userEmail=r.email||"");const n=localStorage.getItem("user_profile_photo");n&&(t.userPhoto=n)})()}selectProfilePhoto(){var t=this;return(0,s.A)(function*(){const r=document.createElement("input");r.type="file",r.accept="image/*",r.onchange=function(){var n=(0,s.A)(function*(o){const g=o.target.files?.[0];if(!g)return;const u=new FileReader;u.onload=()=>{t.userPhoto=u.result,localStorage.setItem("user_profile_photo",t.userPhoto)},u.readAsDataURL(g)});return function(o){return n.apply(this,arguments)}}(),r.click()})()}editName(){var t=this;return(0,s.A)(function*(){var n;yield(yield t.alertCtrl.create({header:"Editar nombre",inputs:[{name:"name",type:"text",value:t.userName}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Guardar",handler:(n=(0,s.A)(function*(o){o.name&&o.name.trim()&&(t.userName=o.name.trim(),yield t.updateUserProfile({name:t.userName}))}),function(g){return n.apply(this,arguments)})}]})).present()})()}editEmail(){var t=this;return(0,s.A)(function*(){var n;yield(yield t.alertCtrl.create({header:"Editar correo",inputs:[{name:"email",type:"email",value:t.userEmail}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Guardar",handler:(n=(0,s.A)(function*(o){o.email&&o.email.includes("@")&&(t.userEmail=o.email.trim(),yield t.updateUserProfile({email:t.userEmail}))}),function(g){return n.apply(this,arguments)})}]})).present()})()}changePassword(){var t=this;return(0,s.A)(function*(){var n;yield(yield t.alertCtrl.create({header:"Cambiar contrasena",inputs:[{name:"currentPassword",type:"password",placeholder:"Contrasena actual"},{name:"newPassword",type:"password",placeholder:"Nueva contrasena"},{name:"confirmPassword",type:"password",placeholder:"Confirmar nueva contrasena"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Cambiar",handler:(n=(0,s.A)(function*(o){return o.currentPassword&&o.newPassword&&o.confirmPassword?o.newPassword.length<6?(t.showToast("La contrasena debe tener al menos 6 caracteres","warning"),!1):o.newPassword!==o.confirmPassword?(t.showToast("Las contrasenas no coinciden","warning"),!1):(t.showToast("Contrasena actualizada","success"),!0):(t.showToast("Completa todos los campos","warning"),!1)}),function(g){return n.apply(this,arguments)})}]})).present()})()}updateUserProfile(t){var r=this;return(0,s.A)(function*(){localStorage.setItem("user_profile_name",t.name||r.userName),localStorage.setItem("user_profile_email",t.email||r.userEmail),r.showToast("Perfil actualizado","success")})()}syncNow(){var t=this;return(0,s.A)(function*(){try{yield t.syncService.syncAll(),t.pendingSync=yield t.syncService.getPendingCount()}catch(r){t.showToast(r.message||"Error al sincronizar","danger")}})()}clearCache(){var t=this;return(0,s.A)(function*(){var n;yield(yield t.alertCtrl.create({header:"Limpiar cache",message:"Esto eliminara los datos almacenados localmente. Los datos sincronizados no se perderan.",buttons:[{text:"Cancelar",role:"cancel"},{text:"Limpiar",role:"destructive",handler:(n=(0,s.A)(function*(){yield t.storageService.clear()}),function(){return n.apply(this,arguments)})}]})).present()})()}logout(){var t=this;return(0,s.A)(function*(){var n;yield(yield t.alertCtrl.create({header:"Cerrar sesion",message:"Estas seguro de que quieres cerrar sesion?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Cerrar sesion",role:"destructive",handler:(n=(0,s.A)(function*(){yield t.authService.logout(),t.router.navigate(["/login"],{replaceUrl:!0})}),function(){return n.apply(this,arguments)})}]})).present()})()}showToast(t,r){var n=this;return(0,s.A)(function*(){yield(yield n.toastCtrl.create({message:t,duration:2500,position:"bottom",color:r})).present()})()}static#e=i=()=>(this.\u0275fac=function(r){return new(r||a)(e.rXU(b.u),e.rXU(P.H),e.rXU(_.n),e.rXU(y.Ix),e.rXU(l.hG),e.rXU(l.K_))},this.\u0275cmp=e.VBU({type:a,selectors:[["app-settings"]],standalone:!1,decls:95,vars:13,consts:[[1,"settings-content"],[1,"user-card"],[1,"user-avatar",3,"click"],["alt","Foto de perfil",3,"src",4,"ngIf"],["name","person",4,"ngIf"],[1,"avatar-edit-badge"],["name","camera"],[1,"user-info"],[1,"section"],[1,"section-header"],[1,"settings-list"],["button","",3,"click"],["name","person-outline","slot","start","color","primary"],["name","chevron-forward-outline","slot","end",1,"chevron-icon"],["name","mail-outline","slot","start","color","primary"],["name","lock-closed-outline","slot","start","color","primary"],["name","sync-outline","slot","start","color","primary"],[4,"ngIf"],["color","warning","slot","end",4,"ngIf"],["name","cloud-outline","slot","start","color","primary"],["slot","end",1,"status-indicator"],["name","trash-outline","slot","start","color","danger"],["name","information-circle-outline","slot","start","color","primary"],[1,"logout-section"],["expand","block","color","danger","fill","outline",3,"click"],["name","log-out-outline","slot","start"],[1,"footer"],["alt","Foto de perfil",3,"src"],["name","person"],["color","warning","slot","end"]],template:function(r,n){1&r&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Ajustes"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"div",1)(6,"div",2),e.bIt("click",function(){return n.selectProfilePhoto()}),e.DNE(7,C,1,1,"img",3)(8,k,1,0,"ion-icon",4),e.j41(9,"div",5),e.nrm(10,"ion-icon",6),e.k0s()(),e.j41(11,"div",7)(12,"h2"),e.EFF(13),e.k0s(),e.j41(14,"p"),e.EFF(15),e.k0s()()(),e.j41(16,"div",8)(17,"div",9),e.EFF(18,"Perfil"),e.k0s(),e.j41(19,"ion-list",10)(20,"ion-item",11),e.bIt("click",function(){return n.editName()}),e.nrm(21,"ion-icon",12),e.j41(22,"ion-label")(23,"h3"),e.EFF(24,"Nombre"),e.k0s(),e.j41(25,"p"),e.EFF(26),e.k0s()(),e.nrm(27,"ion-icon",13),e.k0s(),e.j41(28,"ion-item",11),e.bIt("click",function(){return n.editEmail()}),e.nrm(29,"ion-icon",14),e.j41(30,"ion-label")(31,"h3"),e.EFF(32,"Correo electronico"),e.k0s(),e.j41(33,"p"),e.EFF(34),e.k0s()(),e.nrm(35,"ion-icon",13),e.k0s(),e.j41(36,"ion-item",11),e.bIt("click",function(){return n.changePassword()}),e.nrm(37,"ion-icon",15),e.j41(38,"ion-label")(39,"h3"),e.EFF(40,"Cambiar contrasena"),e.k0s(),e.j41(41,"p"),e.EFF(42,"Actualiza tu contrasena"),e.k0s()(),e.nrm(43,"ion-icon",13),e.k0s()()(),e.j41(44,"div",8)(45,"div",9),e.EFF(46,"Sincronizacion"),e.k0s(),e.j41(47,"ion-list",10)(48,"ion-item",11),e.bIt("click",function(){return n.syncNow()}),e.nrm(49,"ion-icon",16),e.j41(50,"ion-label")(51,"h3"),e.EFF(52,"Sincronizar ahora"),e.k0s(),e.DNE(53,x,2,1,"p",17)(54,F,2,0,"p",17),e.k0s(),e.DNE(55,M,2,1,"ion-badge",18),e.k0s(),e.j41(56,"ion-item"),e.nrm(57,"ion-icon",19),e.j41(58,"ion-label")(59,"h3"),e.EFF(60,"Estado de conexion"),e.k0s(),e.j41(61,"p"),e.EFF(62),e.k0s()(),e.nrm(63,"div",20),e.k0s()()(),e.j41(64,"div",8)(65,"div",9),e.EFF(66,"Almacenamiento"),e.k0s(),e.j41(67,"ion-list",10)(68,"ion-item",11),e.bIt("click",function(){return n.clearCache()}),e.nrm(69,"ion-icon",21),e.j41(70,"ion-label")(71,"h3"),e.EFF(72,"Limpiar cache"),e.k0s(),e.j41(73,"p"),e.EFF(74,"Eliminar datos locales"),e.k0s()()()()(),e.j41(75,"div",8)(76,"div",9),e.EFF(77,"Acerca de"),e.k0s(),e.j41(78,"ion-list",10)(79,"ion-item"),e.nrm(80,"ion-icon",22),e.j41(81,"ion-label")(82,"h3"),e.EFF(83,"Version"),e.k0s(),e.j41(84,"p"),e.EFF(85),e.k0s()()()()(),e.j41(86,"div",23)(87,"ion-button",24),e.bIt("click",function(){return n.logout()}),e.nrm(88,"ion-icon",25),e.EFF(89," Cerrar sesion "),e.k0s()(),e.j41(90,"div",26)(91,"p"),e.EFF(92,"GeoTech - Gestion de proyectos"),e.k0s(),e.j41(93,"p"),e.EFF(94,"Aplicacion para ingenieria civil"),e.k0s()()()),2&r&&(e.R7$(7),e.Y8G("ngIf",n.userPhoto),e.R7$(),e.Y8G("ngIf",!n.userPhoto),e.R7$(5),e.JRh(n.userName),e.R7$(2),e.JRh(n.userEmail),e.R7$(11),e.JRh(n.userName),e.R7$(8),e.JRh(n.userEmail),e.R7$(19),e.Y8G("ngIf",n.pendingSync>0),e.R7$(),e.Y8G("ngIf",0===n.pendingSync),e.R7$(),e.Y8G("ngIf",n.pendingSync>0),e.R7$(7),e.JRh(n.isOnline?"Conectado":"Sin conexion"),e.R7$(),e.AVh("online",n.isOnline),e.R7$(22),e.JRh(n.appVersion))},dependencies:[m.bT,l.In,l.Jm,l.W9,l.eU,l.iq,l.uz,l.he,l.nf,l.BC,l.ai],styles:[".settings-content[_ngcontent-%COMP%]{--background: var(--geotech-bg-dark)}.user-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00d4ff33,#7c3aed33);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid var(--geotech-border-glass);padding:32px 24px;display:flex;align-items:center;gap:20px}.user-avatar[_ngcontent-%COMP%]{width:72px;height:72px;border-radius:50%;background:var(--geotech-bg-glass);border:2px solid var(--geotech-accent-cyan);box-shadow:var(--geotech-glow-cyan);display:flex;align-items:center;justify-content:center;position:relative;cursor:pointer;overflow:hidden}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-avatar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px;color:var(--geotech-accent-cyan)}.user-avatar[_ngcontent-%COMP%]   .avatar-edit-badge[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;width:24px;height:24px;background:var(--geotech-accent-cyan);border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid var(--geotech-bg-dark)}.user-avatar[_ngcontent-%COMP%]   .avatar-edit-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px;color:var(--geotech-bg-dark)}.user-avatar[_ngcontent-%COMP%]:active{transform:scale(.95)}.user-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--geotech-text-primary);font-size:22px;font-weight:700;margin:0 0 6px}.user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--geotech-text-secondary);font-size:14px;margin:0}.section[_ngcontent-%COMP%]{padding:20px}.section-header[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--geotech-accent-cyan);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:12px;padding-left:4px}.settings-list[_ngcontent-%COMP%]{background:transparent;padding:0}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--geotech-bg-glass);--border-radius: var(--geotech-radius-lg);--padding-start: 16px;--min-height: 72px;margin-bottom:10px;border:1px solid var(--geotech-border-glass);border-radius:var(--geotech-radius-lg);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);transition:all .3s ease}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{border-color:#00d4ff4d}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[slot=start][_ngcontent-%COMP%]{font-size:24px;color:var(--geotech-accent-cyan);margin-right:16px}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:var(--geotech-text-primary);margin:0 0 4px}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;color:var(--geotech-text-muted);margin:0}.settings-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .chevron-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--geotech-text-muted)}.status-indicator[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:var(--geotech-text-muted);box-shadow:0 0 0 3px #64748b33}.status-indicator.online[_ngcontent-%COMP%]{background:var(--geotech-accent-green);box-shadow:0 0 8px var(--geotech-accent-green),0 0 0 3px #10b98133}.logout-section[_ngcontent-%COMP%]{padding:20px}.logout-section[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(239, 68, 68, .15);--color: var(--geotech-accent-red);--border-radius: var(--geotech-radius-md);--border-width: 1px;--border-color: rgba(239, 68, 68, .3);height:52px;font-weight:600;text-transform:none;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.logout-section[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--background: rgba(239, 68, 68, .25)}.footer[_ngcontent-%COMP%]{text-align:center;padding:32px 20px;border-top:1px solid var(--geotech-border-glass)}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:var(--geotech-text-muted);margin:0;line-height:1.8}ion-toggle[_ngcontent-%COMP%]{--background: rgba(100, 116, 139, .3);--background-checked: var(--geotech-accent-cyan);--handle-background: var(--geotech-text-primary);--handle-background-checked: var(--geotech-bg-dark)}"]}))}return i(),a})();var f=c(2615);const E=[{path:"",component:O}];let w=(()=>{var i;class a{static#e=i=()=>(this.\u0275fac=function(r){return new(r||a)},this.\u0275mod=e.$C({type:a}),this.\u0275inj=f.G2t({imports:[p.iI.forChild(E),p.iI]}))}return i(),a})(),S=(()=>{var i;class a{static#e=i=()=>(this.\u0275fac=function(r){return new(r||a)},this.\u0275mod=e.$C({type:a}),this.\u0275inj=f.G2t({imports:[m.MD,v.YN,l.bv,w]}))}return i(),a})()}}]);