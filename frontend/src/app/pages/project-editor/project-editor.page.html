<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ project?.name || 'Editor' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="showExportOptions()">
        <ion-icon slot="icon-only" name="share-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <!-- Map Container -->
  <div id="editorMap" class="editor-map"></div>

  <!-- Stats Panel -->
  <div class="stats-panel">
    <div class="stat-item">
      <ion-icon name="shapes-outline"></ion-icon>
      <span>{{ zoneCount }}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="git-branch-outline"></ion-icon>
      <span>{{ pathCount }}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="location-outline"></ion-icon>
      <span>{{ markerCount }}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="camera-outline"></ion-icon>
      <span>{{ photoCount }}</span>
    </div>
  </div>

  <!-- Drawing Controls (visible when drawing) -->
  <div class="drawing-controls" *ngIf="drawMode !== 'none'">
    <div class="drawing-info">
      <span *ngIf="drawMode === 'zone'">Dibujando zona ({{ currentPoints.length }} puntos)</span>
      <span *ngIf="drawMode === 'path'">Trazando vial ({{ currentPoints.length }} puntos)</span>
      <span *ngIf="drawMode === 'marker'">Toca para colocar punto</span>
    </div>
    <div class="drawing-buttons">
      <ion-button size="small" color="medium" (click)="undoLastPoint()" [disabled]="currentPoints.length === 0">
        <ion-icon slot="start" name="arrow-undo"></ion-icon>
        Deshacer
      </ion-button>
      <ion-button size="small" color="danger" (click)="cancelDrawing()">
        <ion-icon slot="start" name="close"></ion-icon>
        Cancelar
      </ion-button>
      <ion-button size="small" color="success" (click)="finishDrawing()" [disabled]="currentPoints.length < 2" *ngIf="drawMode !== 'marker'">
        <ion-icon slot="start" name="checkmark"></ion-icon>
        Guardar
      </ion-button>
    </div>
  </div>

  <!-- Tools Panel -->
  <div class="tools-panel" *ngIf="drawMode === 'none'">
    <ion-button
      class="tool-btn"
      color="light"
      (click)="setDrawMode('zone')"
      title="Dibujar zona">
      <ion-icon slot="icon-only" name="shapes-outline"></ion-icon>
    </ion-button>
    <ion-button
      class="tool-btn"
      color="light"
      (click)="setDrawMode('path')"
      title="Trazar vial">
      <ion-icon slot="icon-only" name="git-branch-outline"></ion-icon>
    </ion-button>
    <ion-button
      class="tool-btn"
      color="light"
      (click)="setDrawMode('marker')"
      title="Agregar punto">
      <ion-icon slot="icon-only" name="location-outline"></ion-icon>
    </ion-button>
    <ion-button
      class="tool-btn"
      color="light"
      (click)="takePhoto()"
      title="Tomar foto">
      <ion-icon slot="icon-only" name="camera"></ion-icon>
    </ion-button>
  </div>

  <!-- Locate Me Button -->
  <ion-button class="locate-btn" color="light" (click)="locateMe()">
    <ion-icon slot="icon-only" name="locate"></ion-icon>
  </ion-button>
</ion-content>
